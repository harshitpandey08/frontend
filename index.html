<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HawkVision Automation - Industrial Safety System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'hawk-primary': '#0A4D3C',
                        'hawk-secondary': '#16A085',
                        'hawk-accent': '#27AE60',
                        'hawk-dark': '#0D1B2A',
                        'hawk-light': '#E8F4F2',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(10, 77, 60, 0.15);
        }
        .status-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
    
    <!-- Main Container -->
    <div id="app" class="max-w-7xl mx-auto p-6">
        
        <!-- Header -->
        <header class="mb-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-hawk-primary to-hawk-secondary rounded-xl flex items-center justify-center shadow-lg">
                        <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900">Automation</h1>
                        <p class="text-sm text-gray-600">AI-Driven Industrial Safety Control</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="text-right mr-3">
                        <p class="text-xs text-gray-500">Edge Status</p>
                        <p class="text-sm font-semibold text-hawk-secondary flex items-center">
                            <span class="w-2 h-2 bg-hawk-secondary rounded-full mr-2 status-pulse"></span>
                            3 Devices Online
                        </p>
                    </div>
                    <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium text-sm">
                        Settings
                    </button>
                </div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <div class="mb-6">
            <div class="glass-effect rounded-xl shadow-md p-2 inline-flex space-x-1">
                <button onclick="switchTab('rules')" id="tab-rules" class="tab-button px-6 py-2.5 rounded-lg font-semibold text-sm transition-all bg-hawk-primary text-white shadow-md">
                    Rules
                </button>
                <button onclick="switchTab('devices')" id="tab-devices" class="tab-button px-6 py-2.5 rounded-lg font-semibold text-sm transition-all text-gray-600 hover:bg-gray-100">
                    Devices
                </button>
                <button onclick="switchTab('capabilities')" id="tab-capabilities" class="tab-button px-6 py-2.5 rounded-lg font-semibold text-sm transition-all text-gray-600 hover:bg-gray-100">
                    Capabilities
                </button>
            </div>
        </div>

        <!-- RULES VIEW -->
        <div id="rules-view" class="tab-content">
            
            <!-- Action Bar -->
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center space-x-3">
                    <input type="text" placeholder="Search rules..." class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none w-64">
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                        <option>All Rules</option>
                        <option>Active</option>
                        <option>Inactive</option>
                    </select>
                </div>
                <button onclick="openCreateRuleModal()" class="px-6 py-2.5 bg-gradient-to-r from-hawk-primary to-hawk-secondary text-white rounded-lg hover:shadow-lg transition-all font-semibold flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    <span>Add Rule</span>
                </button>
            </div>

            <!-- Rules Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                
                <!-- Rule Card 1 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 card-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Fire Alarm Response</h3>
                                <p class="text-xs text-gray-500 mt-0.5">ID: fire_rule_1</p>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>

                    <div class="space-y-3 mb-4">
                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700">Trigger</p>
                                <p class="text-sm text-gray-600">Fire Detected (confidence ≥ 0.8)</p>
                                <span class="badge bg-gray-100 text-gray-700 mt-1">Zone: Warehouse</span>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
                            </svg>
                            <div class="flex-1">
                                <p class="text-sm font-semibold text-gray-700 mb-2">Actions</p>
                                <div class="space-y-1.5">
                                    <div class="flex items-center justify-between bg-red-50 px-3 py-2 rounded-lg">
                                        <span class="text-xs font-medium text-red-700">Alarm → Turn On</span>
                                        <span class="text-xs text-red-600">steady, 20s</span>
                                    </div>
                                    <div class="flex items-center justify-between bg-orange-50 px-3 py-2 rounded-lg">
                                        <span class="text-xs font-medium text-orange-700">Machine Power → Stop All</span>
                                        <span class="text-xs text-orange-600">immediate</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700 mb-1.5">Target Devices</p>
                                <div class="flex flex-wrap gap-1.5">
                                    <span class="badge bg-hawk-light text-hawk-primary">Hooter Warehouse 1</span>
                                    <span class="badge bg-hawk-light text-hawk-primary">CNC Machine A1</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                        <div class="flex items-center space-x-2">
                            <span class="w-2 h-2 bg-green-500 rounded-full status-pulse"></span>
                            <span class="text-sm font-medium text-green-700">Active</span>
                        </div>
                        <div class="flex items-center space-x-2 text-xs text-gray-500">
                            <span>Last triggered: 2 hours ago</span>
                        </div>
                    </div>
                </div>

                <!-- Rule Card 2 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 card-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Site Entry Gate Auto</h3>
                                <p class="text-xs text-gray-500 mt-0.5">ID: gate_entry_rule</p>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>

                    <div class="space-y-3 mb-4">
                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700">Trigger</p>
                                <p class="text-sm text-gray-600">ANPR Match (confidence ≥ 0.95)</p>
                                <span class="badge bg-gray-100 text-gray-700 mt-1">Zone: Gate 1</span>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700 mb-1.5">Condition</p>
                                <div class="bg-blue-50 px-3 py-2 rounded-lg">
                                    <p class="text-xs font-medium text-blue-700">If license plate is whitelisted</p>
                                </div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
                            </svg>
                            <div class="flex-1">
                                <p class="text-sm font-semibold text-gray-700 mb-2">Actions</p>
                                <div class="flex items-center justify-between bg-green-50 px-3 py-2 rounded-lg">
                                    <span class="text-xs font-medium text-green-700">Access Control → Open</span>
                                    <span class="text-xs text-green-600">5s duration</span>
                                </div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700 mb-1.5">Target Devices</p>
                                <div class="flex flex-wrap gap-1.5">
                                    <span class="badge bg-hawk-light text-hawk-primary">Gate 12 Controller</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                        <div class="flex items-center space-x-2">
                            <span class="w-2 h-2 bg-green-500 rounded-full status-pulse"></span>
                            <span class="text-sm font-medium text-green-700">Active</span>
                        </div>
                        <div class="flex items-center space-x-2 text-xs text-gray-500">
                            <span>Last triggered: 15 mins ago</span>
                        </div>
                    </div>
                </div>

                <!-- Rule Card 3 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 card-hover opacity-75">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Material Spill Alert</h3>
                                <p class="text-xs text-gray-500 mt-0.5">ID: spill_alert_1</p>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>

                    <div class="space-y-3 mb-4">
                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700">Trigger</p>
                                <p class="text-sm text-gray-600">Material Spill (confidence ≥ 0.85)</p>
                                <span class="badge bg-gray-100 text-gray-700 mt-1">Zone: Production Floor</span>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
                            </svg>
                            <div class="flex-1">
                                <p class="text-sm font-semibold text-gray-700 mb-2">Actions</p>
                                <div class="flex items-center justify-between bg-purple-50 px-3 py-2 rounded-lg">
                                    <span class="text-xs font-medium text-purple-700">Alarm → Turn On</span>
                                    <span class="text-xs text-purple-600">pulse, 30s</span>
                                </div>
                            </div>
                        </div>

                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-gray-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                            </svg>
                            <div>
                                <p class="text-sm font-semibold text-gray-700 mb-1.5">Target Devices</p>
                                <div class="flex flex-wrap gap-1.5">
                                    <span class="badge bg-hawk-light text-hawk-primary">Hooter East</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                        <div class="flex items-center space-x-2">
                            <span class="w-2 h-2 bg-gray-400 rounded-full"></span>
                            <span class="text-sm font-medium text-gray-600">Inactive</span>
                        </div>
                        <div class="flex items-center space-x-2 text-xs text-gray-500">
                            <span>Never triggered</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- DEVICES VIEW -->
        <div id="devices-view" class="tab-content hidden">
            
            <!-- Action Bar -->
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center space-x-3">
                    <input type="text" placeholder="Search devices..." class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none w-64">
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                        <option>All Devices</option>
                        <option>Online</option>
                        <option>Offline</option>
                    </select>
                </div>
                <button onclick="openAddDeviceModal()" class="px-6 py-2.5 bg-gradient-to-r from-hawk-primary to-hawk-secondary text-white rounded-lg hover:shadow-lg transition-all font-semibold flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    <span>Add Device</span>
                </button>
            </div>

            <!-- Devices Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                
                <!-- Device Card 1 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 card-hover">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-orange-500 rounded-xl flex items-center justify-center shadow-md">
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-base font-bold text-gray-900">Hooter Warehouse 1</h3>
                                <p class="text-xs text-gray-500 mt-0.5">ID: hooter_wh_1</p>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>

                    <div class="space-y-3 mb-4">
                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Edge Device</p>
                            <div class="flex items-center space-x-2">
                                <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                <span class="text-sm font-medium text-gray-900">edge_01 (Warehouse)</span>
                            </div>
                        </div>

                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Capabilities</p>
                            <div class="flex flex-wrap gap-1.5">
                                <span class="badge bg-red-50 text-red-700">Alarm</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">turn_on, turn_off</p>
                        </div>

                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Hardware Details</p>
                            <div class="bg-gray-50 rounded-lg p-3 space-y-1">
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">Connector:</span>
                                    <span class="font-medium text-gray-900">GPIO</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">Pin:</span>
                                    <span class="font-medium text-gray-900">17</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pt-3 border-t border-gray-200">
                        <div class="flex items-center justify-between text-xs text-gray-500">
                            <span>Used in <strong class="text-hawk-primary">2 rules</strong></span>
                            <span class="text-green-600 font-medium">● Online</span>
                        </div>
                    </div>
                </div>

                <!-- Device Card 2 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 card-hover">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-xl flex items-center justify-center shadow-md">
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-base font-bold text-gray-900">Gate 12 Controller</h3>
                                <p class="text-xs text-gray-500 mt-0.5">ID: gate_12</p>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>

                    <div class="space-y-3 mb-4">
                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Edge Device</p>
                            <div class="flex items-center space-x-2">
                                <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                <span class="text-sm font-medium text-gray-900">edge_01 (Warehouse)</span>
                            </div>
                        </div>

                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Capabilities</p>
                            <div class="flex flex-wrap gap-1.5">
                                <span class="badge bg-blue-50 text-blue-700">Access Control</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">open, close</p>
                        </div>

                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Hardware Details</p>
                            <div class="bg-gray-50 rounded-lg p-3 space-y-1">
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">Connector:</span>
                                    <span class="font-medium text-gray-900">Modbus</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">IP:</span>
                                    <span class="font-medium text-gray-900">192.168.1.100</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">Coil:</span>
                                    <span class="font-medium text-gray-900">40001</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pt-3 border-t border-gray-200">
                        <div class="flex items-center justify-between text-xs text-gray-500">
                            <span>Used in <strong class="text-hawk-primary">1 rule</strong></span>
                            <span class="text-green-600 font-medium">● Online</span>
                        </div>
                    </div>
                </div>

                <!-- Device Card 3 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 card-hover">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-xl flex items-center justify-center shadow-md">
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-base font-bold text-gray-900">CNC Machine A1</h3>
                                <p class="text-xs text-gray-500 mt-0.5">ID: cnc_a1</p>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path>
                            </svg>
                        </button>
                    </div>

                    <div class="space-y-3 mb-4">
                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Edge Device</p>
                            <div class="flex items-center space-x-2">
                                <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                <span class="text-sm font-medium text-gray-900">edge_02 (Production)</span>
                            </div>
                        </div>

                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Capabilities</p>
                            <div class="flex flex-wrap gap-1.5">
                                <span class="badge bg-orange-50 text-orange-700">Machine Power</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">start, stop, emergency_stop</p>
                        </div>

                        <div>
                            <p class="text-xs font-semibold text-gray-500 uppercase mb-1.5">Hardware Details</p>
                            <div class="bg-gray-50 rounded-lg p-3 space-y-1">
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">Connector:</span>
                                    <span class="font-medium text-gray-900">PLC</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">Protocol:</span>
                                    <span class="font-medium text-gray-900">S7</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-gray-600">DB:</span>
                                    <span class="font-medium text-gray-900">DB1.DBX0.0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pt-3 border-t border-gray-200">
                        <div class="flex items-center justify-between text-xs text-gray-500">
                            <span>Used in <strong class="text-hawk-primary">1 rule</strong></span>
                            <span class="text-green-600 font-medium">● Online</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- CAPABILITIES VIEW -->
        <div id="capabilities-view" class="tab-content hidden">
            
            <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200 mb-6">
                <div class="flex items-start space-x-4">
                    <div class="w-12 h-12 bg-hawk-secondary/10 rounded-xl flex items-center justify-center">
                        <svg class="w-7 h-7 text-hawk-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-900 mb-1">Capability Registry</h3>
                        <p class="text-sm text-gray-600">Standard capabilities define what devices can do. These are semantic contracts that remain stable across hardware changes.</p>
                    </div>
                </div>
            </div>

            <!-- Capabilities Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                
                <!-- Capability Card 1 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Alarm</h3>
                                <p class="text-xs text-gray-500">Audible warning devices</p>
                            </div>
                        </div>
                        <span class="badge bg-green-50 text-green-700">Stable</span>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Commands</p>
                            
                            <div class="space-y-2">
                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900 mb-2">turn_on</p>
                                    <div class="space-y-1 text-xs">
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">duration_sec</span>
                                            <span class="font-mono text-gray-900">int (1-300)</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">pattern</span>
                                            <span class="font-mono text-gray-900">enum: steady, pulse</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900">turn_off</p>
                                    <p class="text-xs text-gray-500 mt-1">No parameters</p>
                                </div>
                            </div>
                        </div>

                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Safety Policy</p>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                <div class="flex items-start space-x-2">
                                    <svg class="w-4 h-4 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    <div class="text-xs space-y-1">
                                        <p><span class="font-semibold">Min Confidence:</span> 0.8</p>
                                        <p><span class="font-semibold">Cooldown:</span> 60 seconds</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 pt-3 border-t border-gray-200 text-xs text-gray-500">
                        Compatible with: GPIO, Modbus, HTTP, MQTT connectors
                    </div>
                </div>

                <!-- Capability Card 2 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Access Control</h3>
                                <p class="text-xs text-gray-500">Gate and barrier control</p>
                            </div>
                        </div>
                        <span class="badge bg-green-50 text-green-700">Stable</span>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Commands</p>
                            
                            <div class="space-y-2">
                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900 mb-2">open</p>
                                    <div class="space-y-1 text-xs">
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">duration_sec</span>
                                            <span class="font-mono text-gray-900">int (1-60)</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">auto_close</span>
                                            <span class="font-mono text-gray-900">boolean</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900">close</p>
                                    <p class="text-xs text-gray-500 mt-1">No parameters</p>
                                </div>
                            </div>
                        </div>

                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Safety Policy</p>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                <div class="flex items-start space-x-2">
                                    <svg class="w-4 h-4 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    <div class="text-xs space-y-1">
                                        <p><span class="font-semibold">Min Confidence:</span> 0.95</p>
                                        <p><span class="font-semibold">Cooldown:</span> 10 seconds</p>
                                        <p><span class="font-semibold">Max per hour:</span> 50</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 pt-3 border-t border-gray-200 text-xs text-gray-500">
                        Compatible with: Modbus, HTTP, Relay connectors
                    </div>
                </div>

                <!-- Capability Card 3 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Machine Power</h3>
                                <p class="text-xs text-gray-500">Industrial machine control</p>
                            </div>
                        </div>
                        <span class="badge bg-green-50 text-green-700">Stable</span>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Commands</p>
                            
                            <div class="space-y-2">
                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900 mb-2">start</p>
                                    <div class="space-y-1 text-xs">
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">delay_sec</span>
                                            <span class="font-mono text-gray-900">int (0-30)</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900">stop</p>
                                    <p class="text-xs text-gray-500 mt-1">No parameters</p>
                                </div>

                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900">emergency_stop</p>
                                    <p class="text-xs text-red-600 mt-1">Immediate safety shutdown</p>
                                </div>
                            </div>
                        </div>

                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Safety Policy</p>
                            <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                                <div class="flex items-start space-x-2">
                                    <svg class="w-4 h-4 text-red-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    <div class="text-xs space-y-1">
                                        <p><span class="font-semibold">Min Confidence:</span> 0.9</p>
                                        <p><span class="font-semibold">Cooldown:</span> 300 seconds</p>
                                        <p><span class="font-semibold">Manual Override:</span> Required</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 pt-3 border-t border-gray-200 text-xs text-gray-500">
                        Compatible with: PLC, Modbus, Industrial protocols
                    </div>
                </div>

                <!-- Capability Card 4 -->
                <div class="glass-effect rounded-xl p-6 shadow-md border border-gray-200">
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex items-start space-x-3">
                            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900">Notification</h3>
                                <p class="text-xs text-gray-500">Alert and messaging</p>
                            </div>
                        </div>
                        <span class="badge bg-green-50 text-green-700">Stable</span>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Commands</p>
                            
                            <div class="space-y-2">
                                <div class="bg-gray-50 rounded-lg p-3">
                                    <p class="text-sm font-medium text-gray-900 mb-2">send</p>
                                    <div class="space-y-1 text-xs">
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">message</span>
                                            <span class="font-mono text-gray-900">string</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">priority</span>
                                            <span class="font-mono text-gray-900">enum: low, medium, high</span>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-gray-600">channels</span>
                                            <span class="font-mono text-gray-900">array</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <p class="text-sm font-semibold text-gray-700 mb-2">Safety Policy</p>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                <div class="flex items-start space-x-2">
                                    <svg class="w-4 h-4 text-yellow-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    <div class="text-xs space-y-1">
                                        <p><span class="font-semibold">Min Confidence:</span> 0.7</p>
                                        <p><span class="font-semibold">Cooldown:</span> 30 seconds</p>
                                        <p><span class="font-semibold">Max per hour:</span> 100</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 pt-3 border-t border-gray-200 text-xs text-gray-500">
                        Compatible with: Email, SMS, Webhook, Slack connectors
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- Add Device Modal (Hidden by default) -->
    <div id="addDeviceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass-effect rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="sticky top-0 glass-effect border-b border-gray-200 p-6 rounded-t-2xl">
                <div class="flex items-center justify-between">
                    <h2 class="text-2xl font-bold text-gray-900">Add New Device</h2>
                    <button onclick="closeAddDeviceModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="p-6 space-y-6">
                <!-- Step 1: Basic Info -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">1. Basic Information</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Device Name</label>
                            <input type="text" placeholder="e.g., Hooter Warehouse 2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Device ID (Unique Identifier)</label>
                            <input type="text" placeholder="e.g., hooter_wh_2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Edge Device</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                <option>Select edge device...</option>
                                <option>edge_01 (Warehouse)</option>
                                <option>edge_02 (Production Floor)</option>
                                <option>edge_03 (Gate Area)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Capability Selection -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">2. Capability Configuration</h3>
                    
                    <div class="space-y-4">
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                            <div class="flex items-start justify-between mb-3">
                                <p class="text-sm font-semibold text-gray-700">Capability 1</p>
                                <button class="text-red-600 hover:text-red-700 text-sm">Remove</button>
                            </div>
                            
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs font-medium text-gray-700 mb-1">Capability Type</label>
                                    <select id="capabilityType1" onchange="updateCommandsForCapability('capabilityType1', 'commandList1')" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                        <option>Select capability...</option>
                                        <option value="alarm">Alarm</option>
                                        <option value="access_control">Access Control</option>
                                        <option value="machine_power">Machine Power</option>
                                        <option value="notification">Notification</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-gray-700 mb-1.5">Available Commands</label>
                                    <div id="commandList1" class="space-y-1.5">
                                        <p class="text-xs text-gray-500 italic">Select a capability to see available commands</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button class="w-full py-2 px-4 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-hawk-secondary hover:text-hawk-secondary transition-colors font-medium text-sm">
                            + Add Another Capability
                        </button>
                    </div>
                </div>

                <!-- Step 3: Hardware Mapping -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">3. Hardware Mapping</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Connector Type</label>
                            <select id="connectorType" onchange="updateHardwareFields()" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                <option>Select connector...</option>
                                <option value="gpio">GPIO</option>
                                <option value="modbus">Modbus</option>
                                <option value="http">HTTP/REST API</option>
                                <option value="plc">PLC (S7/Industrial)</option>
                                <option value="mqtt">MQTT</option>
                            </select>
                        </div>

                        <!-- GPIO Fields -->
                        <div id="gpioFields" class="hidden space-y-4">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <p class="text-sm font-semibold text-gray-900 mb-3">GPIO Configuration</p>
                                
                                <div class="space-y-3">
                                    <div>
                                        <p class="text-xs font-medium text-gray-700 mb-2">Command: turn_on</p>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Pin Number</label>
                                                <input type="number" placeholder="17" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Value</label>
                                                <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                                    <option>1 (HIGH)</option>
                                                    <option>0 (LOW)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <p class="text-xs font-medium text-gray-700 mb-2">Command: turn_off</p>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Pin Number</label>
                                                <input type="number" placeholder="17" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Value</label>
                                                <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                                    <option>0 (LOW)</option>
                                                    <option>1 (HIGH)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Modbus Fields -->
                        <div id="modbusFields" class="hidden space-y-4">
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <p class="text-sm font-semibold text-gray-900 mb-3">Modbus Configuration</p>
                                
                                <div class="space-y-3">
                                    <div class="grid grid-cols-3 gap-3">
                                        <div class="col-span-2">
                                            <label class="block text-xs text-gray-600 mb-1">IP Address</label>
                                            <input type="text" placeholder="192.168.1.100" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                        </div>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">Port</label>
                                            <input type="number" placeholder="502" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                        </div>
                                    </div>

                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Slave ID</label>
                                        <input type="number" placeholder="1" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                    </div>

                                    <div>
                                        <p class="text-xs font-medium text-gray-700 mb-2">Command: turn_on</p>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Coil Address</label>
                                                <input type="number" placeholder="40001" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Value</label>
                                                <input type="number" placeholder="1" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <p class="text-xs font-medium text-gray-700 mb-2">Command: turn_off</p>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Coil Address</label>
                                                <input type="number" placeholder="40001" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Value</label>
                                                <input type="number" placeholder="0" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- HTTP Fields -->
                        <div id="httpFields" class="hidden space-y-4">
                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                <p class="text-sm font-semibold text-gray-900 mb-3">HTTP/REST API Configuration</p>
                                
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Base URL</label>
                                        <input type="text" placeholder="http://device.local/api" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                    </div>

                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Authentication (Optional)</label>
                                        <input type="text" placeholder="API Key or Bearer Token" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                    </div>

                                    <div>
                                        <p class="text-xs font-medium text-gray-700 mb-2">Command: turn_on</p>
                                        <div class="space-y-2">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Endpoint</label>
                                                <input type="text" placeholder="/alarm/on" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            </div>
                                            <div class="grid grid-cols-2 gap-3">
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1">Method</label>
                                                    <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                                        <option>POST</option>
                                                        <option>GET</option>
                                                        <option>PUT</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1">Content-Type</label>
                                                    <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                                        <option>application/json</option>
                                                        <option>application/x-www-form-urlencoded</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Request Body (JSON)</label>
                                                <textarea placeholder='{"duration": "{{duration_sec}}", "pattern": "{{pattern}}"}' rows="2" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none font-mono"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PLC Fields -->
                        <div id="plcFields" class="hidden space-y-4">
                            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                <p class="text-sm font-semibold text-gray-900 mb-3">PLC Configuration</p>
                                
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Protocol</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                            <option>Siemens S7</option>
                                            <option>Allen-Bradley</option>
                                            <option>Modbus TCP</option>
                                        </select>
                                    </div>

                                    <div class="grid grid-cols-2 gap-3">
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">IP Address</label>
                                            <input type="text" placeholder="192.168.1.50" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                        </div>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">Rack/Slot</label>
                                            <input type="text" placeholder="0/1" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                        </div>
                                    </div>

                                    <div>
                                        <p class="text-xs font-medium text-gray-700 mb-2">Command: stop</p>
                                        <div>
                                            <label class="block text-xs text-gray-600 mb-1">Data Block Address</label>
                                            <input type="text" placeholder="DB1.DBX0.0" class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-hawk-secondary outline-none">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Test Connection -->
                <div class="border-t border-gray-200 pt-6">
                    <div class="bg-gray-50 rounded-lg p-4 flex items-center justify-between">
                        <div>
                            <p class="text-sm font-semibold text-gray-900">Test Connection</p>
                            <p class="text-xs text-gray-600 mt-0.5">Verify device responds before saving</p>
                        </div>
                        <button class="px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors font-medium text-sm">
                            Test Now
                        </button>
                    </div>
                </div>
            </div>

            <div class="sticky bottom-0 glass-effect border-t border-gray-200 p-6 rounded-b-2xl flex justify-end space-x-3">
                <button onclick="closeAddDeviceModal()" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">
                    Cancel
                </button>
                <button class="px-6 py-2 bg-gradient-to-r from-hawk-primary to-hawk-secondary text-white rounded-lg hover:shadow-lg transition-all font-semibold">
                    Add Device
                </button>
            </div>
        </div>
    </div>

    <!-- Create Rule Modal (Hidden by default) -->
    <div id="createRuleModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="glass-effect rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="sticky top-0 glass-effect border-b border-gray-200 p-6 rounded-t-2xl">
                <div class="flex items-center justify-between">
                    <h2 class="text-2xl font-bold text-gray-900">Create Automation Rule</h2>
                    <button onclick="closeCreateRuleModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="p-6 space-y-6">
                <!-- Step 1: Basic Info -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">1. Basic Information</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Rule Name</label>
                            <input type="text" placeholder="e.g., Fire Alarm Response" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description (Optional)</label>
                            <textarea placeholder="Describe what this rule does..." rows="2" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Trigger Configuration -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">2. Trigger Configuration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Incident Type</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                <option>Select incident type...</option>
                                <option>Fire Detected</option>
                                <option>Person in Unsafe Zone</option>
                                <option>Material Spill</option>
                                <option>ANPR Match</option>
                                <option>Near Miss</option>
                                <option>Intrusion Detection</option>
                            </select>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Confidence</label>
                                <div class="flex items-center space-x-3">
                                    <input type="range" min="0" max="100" value="80" class="flex-1">
                                    <span class="text-sm font-medium text-gray-900 w-12">0.80</span>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Zone</label>
                                <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                    <option>All Zones</option>
                                    <option>Warehouse</option>
                                    <option>Production Floor</option>
                                    <option>Gate 1</option>
                                    <option>Loading Dock</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Action Selection -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">3. Actions</h3>
                    
                    <div class="space-y-4">
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                            <div class="flex items-start justify-between mb-3">
                                <p class="text-sm font-semibold text-gray-700">Action 1</p>
                                <button class="text-red-600 hover:text-red-700 text-sm">Remove</button>
                            </div>
                            
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs font-medium text-gray-700 mb-1">Capability</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                        <option>Select capability...</option>
                                        <option>Alarm</option>
                                        <option>Access Control</option>
                                        <option>Machine Power</option>
                                        <option>Notification</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-gray-700 mb-1">Command</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                        <option>turn_on</option>
                                        <option>turn_off</option>
                                    </select>
                                </div>

                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 mb-1">Duration (sec)</label>
                                        <input type="number" value="20" min="1" max="300" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700 mb-1">Pattern</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                                            <option>steady</option>
                                            <option>pulse</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button class="w-full py-2 px-4 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-hawk-secondary hover:text-hawk-secondary transition-colors font-medium text-sm">
                            + Add Another Action
                        </button>
                    </div>
                </div>

                <!-- Step 4: Device Selection -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">4. Target Devices</h3>
                    
                    <div class="space-y-3">
                        <input type="text" placeholder="🔍 Search devices by name, ID, or capability..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                        
                        <div class="max-h-64 overflow-y-auto space-y-2 border border-gray-200 rounded-lg p-3">
                            <label class="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer">
                                <input type="checkbox" class="mt-1 w-4 h-4 text-hawk-primary rounded">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Hooter Warehouse 1</p>
                                    <p class="text-xs text-gray-500">ID: hooter_wh_1 | Edge: edge_01 | Capability: Alarm</p>
                                </div>
                            </label>

                            <label class="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer">
                                <input type="checkbox" class="mt-1 w-4 h-4 text-hawk-primary rounded">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Hooter East Gate</p>
                                    <p class="text-xs text-gray-500">ID: hooter_east | Edge: edge_02 | Capability: Alarm</p>
                                </div>
                            </label>

                            <label class="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer opacity-50">
                                <input type="checkbox" class="mt-1 w-4 h-4 text-hawk-primary rounded" disabled>
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">Gate Controller</p>
                                    <p class="text-xs text-gray-500">Incompatible capability: Access Control</p>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Safety Settings -->
                <div class="border-t border-gray-200 pt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">5. Safety Settings</h3>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 space-y-3">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Cooldown Period (sec)</label>
                                <input type="number" value="300" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Max Executions/Hour</label>
                                <input type="number" value="10" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-hawk-secondary focus:border-transparent outline-none">
                            </div>
                        </div>

                        <label class="flex items-center space-x-2">
                            <input type="checkbox" class="w-4 h-4 text-hawk-primary rounded">
                            <span class="text-sm text-gray-700">Require manual override before execution</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="sticky bottom-0 glass-effect border-t border-gray-200 p-6 rounded-b-2xl flex justify-end space-x-3">
                <button onclick="closeCreateRuleModal()" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">
                    Cancel
                </button>
                <button class="px-6 py-2 bg-gradient-to-r from-hawk-primary to-hawk-secondary text-white rounded-lg hover:shadow-lg transition-all font-semibold">
                    Create Rule
                </button>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tab) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show selected tab content
            document.getElementById(tab + '-view').classList.remove('hidden');
            
            // Update tab button styles
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('bg-hawk-primary', 'text-white', 'shadow-md');
                button.classList.add('text-gray-600', 'hover:bg-gray-100');
            });
            
            // Highlight selected tab
            const selectedTab = document.getElementById('tab-' + tab);
            selectedTab.classList.add('bg-hawk-primary', 'text-white', 'shadow-md');
            selectedTab.classList.remove('text-gray-600', 'hover:bg-gray-100');
        }

        // Modal functions
        function openCreateRuleModal() {
            document.getElementById('createRuleModal').classList.remove('hidden');
        }

        function closeCreateRuleModal() {
            document.getElementById('createRuleModal').classList.add('hidden');
        }

        function openAddDeviceModal() {
            document.getElementById('addDeviceModal').classList.remove('hidden');
        }

        function closeAddDeviceModal() {
            document.getElementById('addDeviceModal').classList.add('hidden');
        }

        // Update hardware fields based on connector type
        function updateHardwareFields() {
            const connectorType = document.getElementById('connectorType').value;
            
            // Hide all fields first
            document.getElementById('gpioFields').classList.add('hidden');
            document.getElementById('modbusFields').classList.add('hidden');
            document.getElementById('httpFields').classList.add('hidden');
            document.getElementById('plcFields').classList.add('hidden');
            
            // Show selected connector fields
            if (connectorType === 'gpio') {
                document.getElementById('gpioFields').classList.remove('hidden');
            } else if (connectorType === 'modbus') {
                document.getElementById('modbusFields').classList.remove('hidden');
            } else if (connectorType === 'http') {
                document.getElementById('httpFields').classList.remove('hidden');
            } else if (connectorType === 'plc') {
                document.getElementById('plcFields').classList.remove('hidden');
            }
        }

        // Update available commands based on capability selection
        function updateCommandsForCapability(capabilitySelectId, commandListId) {
            const capability = document.getElementById(capabilitySelectId).value;
            const commandList = document.getElementById(commandListId);
            
            const capabilityCommands = {
                'alarm': [
                    { name: 'turn_on', params: 'duration_sec, pattern' },
                    { name: 'turn_off', params: 'none' }
                ],
                'access_control': [
                    { name: 'open', params: 'duration_sec, auto_close' },
                    { name: 'close', params: 'none' }
                ],
                'machine_power': [
                    { name: 'start', params: 'delay_sec' },
                    { name: 'stop', params: 'none' },
                    { name: 'emergency_stop', params: 'none' }
                ],
                'notification': [
                    { name: 'send', params: 'message, priority, channels' }
                ]
            };
            
            if (capability && capabilityCommands[capability]) {
                const commands = capabilityCommands[capability];
                let html = '';
                commands.forEach(cmd => {
                    html += `
                        <label class="flex items-center space-x-2 text-xs">
                            <input type="checkbox" checked class="w-3.5 h-3.5 text-hawk-primary rounded">
                            <span class="font-medium text-gray-900">${cmd.name}</span>
                            <span class="text-gray-500">(${cmd.params})</span>
                        </label>
                    `;
                });
                commandList.innerHTML = html;
            } else {
                commandList.innerHTML = '<p class="text-xs text-gray-500 italic">Select a capability to see available commands</p>';
            }
        }

        // Close modal when clicking outside
        document.getElementById('createRuleModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCreateRuleModal();
            }
        });

        document.getElementById('addDeviceModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAddDeviceModal();
            }
        });
    </script>

</body>
</html>
